const {sign, verify, pack, unpack, signAndPack, unpackAndVerify, makeCWT, parseCWT, debug} = require('../lib/index');const expect = require('chai').expect; 

describe('CZ', async () => {
  it('should verify CZ_2DCode_raw_1', async () => {
    const HC1 = 'HC1:NCF0Y20088D0%20WGET KRKM$NGP*K3VSZ0O3YS+9RKAR6/BEF1-0LMHQEET8 71P7LWN7OMQ9HUBHMBKLQ0ZSRUJK*213LDOMGU1JV0J3UHBV44ZR07EJY7FL5ULDEMTDCSOVM*57Q+GO%QARHPK97N6*0IV$RDENQKPSRHB5FGKD4:MNA1 XCU5JU%O*TAUIJD30JZIR+SFYA-B6AC2J%PA42DO42YK%WK8HJ+AF/%CGTBDSJTGN MUA8S7I8JAN600NRQLGK2 3X3DLR6JYDMGNJV1JMN7 A /P .H$IE21SRYD6JRR-4XOPTE6P-8T:CBK2/C3 40.%1-M4MKC*HA1HTN8GISUC10PMVP$S6D9II0UJ5+FSF-MU71N65NXBAQ0016%C2UV0LZ0PY1PIR:XLXI5OS4O2S2H3ALNNJKR DEE9/+TDHBB/2D8RBPPUW6Q:3ZGEZO6/INRR7416PEEYAM97ESV95%PL8V DSNO7Z7GB.NF0VC$5KTI3+G%7IHLFZETR*V*QE50V:0NH-V PNC2S08UN%2V7O21US VZ5O2*3/D3YLBKEV/HQUJQ00P54H';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'dob': '1979-05-06', 'nam': {'fn': 'Daňhelka', 'fnt': 'DANHELKA', 'gn': 'Miroslav', 'gnt': 'MIROSLAV'}, 'v': [{'ci': 'URN:UVCI:01:CZ:6FHKN4275XT78AKVS7BH62EGW339ZNYS', 'co': 'CZ', 'dn': 2, 'dt': '2021-02-25', 'is': 'Ministry of Health of the Czech Republic', 'ma': 'ORG-100030215', 'mp': 'EU/1/20/1528', 'sd': 2, 'tg': '840539006', 'vp': '1119349007'}], 'ver': '1.0.1'});
  });

  it('should verify CZ_2DCode_raw_2', async () => {
    const HC1 = 'HC1:NCFOXN*TS0BI$ZD8UHJN5IZ9$5WELN/A2I:IK$4%29J59$0QUZL-RI4GRXVV NI4EFSYSS%OM6PYE9*FJ UVQC8$.AIGCY0K5$0$/AWCAC-D7HI3*8$AAE$2N1I+CAYJO-6Q//CK.8P 4K72S-DR-9M%5YE9/MVTZU7LAXPMHQ1*P1TU1+ZEE 96IA394TM8322G*L:%5N9C.XI/VBKNSYIJGDBGIASJLA8KOHSLOJJPA*70**I-XKN57N*K%1DJQ0K%2C-4XTC805CZKHKB-43.E3KD3OAJ5AL+-43U1336:K3*IJI7JSTNB95.16S16-.T+SOI%KX N-9MQ*N8%MKMI348T46WEUC.U MI//5TBOFRMLNKNM8JI0NTOI014VSHXD*5DMG9I86/GE+OP7BP 9RVPJ7LKBZRKTL4LHDLGY.FY7UWYEHCQXVTDQK CF.$J.%N6KN0Y9A.1E.5FHQLRS%2I3/I:TMC70ZCV$2';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'dob': '2000-11-19', 'nam': {'fn': 'Novák', 'fnt': 'NOVAK', 'gn': 'Jan', 'gnt': 'JAN'}, 'r': [{'ci': 'URN:UVCI:01:CZ:F8Y624ZP8VA5ZJSZCW652M4XXTF4BQDZ', 'co': 'CZ', 'df': '2021-05-15', 'du': '2021-11-15', 'fr': '2021-05-01', 'is': 'Ministry of Health of the Czech Republic', 'tg': '840539006'}], 'ver': '1.0.1'});
  });

  it('should verify CZ_2DCode_raw_3', async () => {
    const HC1 = 'HC1:NCFU A4C86WQ:20%612N3 %17AF+7LLNCC/84P9:-C*0H+Y9$TRN+MD$D6YRIEF1AM7RD/R7M4S+:UF 0N7J4-GZ42L-A8-2C4KA5AI8LCIO4PEM6E3MQ5GS%-04I5TO111G2GW:+F:LQQ-R.AE0HU SF%8BX*FT:O*62B4VH$Q*VFU4S09QF.VK11P4JEJE9TJ$.3:Q8P2FB.CUPD%KFUK0J3L6Z6HJB 9T:S2T-C/M45:Q0IJM/KR7BKHDRPMK3KZ3BU 25V6TA88T3JNITP4CEGFMAU98W8QAEIJ$G+D3K.LV9G3S5A+PY 1+EOA7KDK2Z+3T:UA43P$NZ/3TDO%A8BK8EIATH9+SL%0BK.GCNE6%1PU1JAA4BDSBVJTN%X9TDOPW87D819NQ99LLLV4162AVA4I GUGL3HJPF6E89*RAAS2AG8U95%*2H9C:UC9KL%FPYZJHGIYDCPWAAHLJ590X8MW0D18W-JX3DK970IL6/J-6D 0SIWJMRVOK624VY$9X619HM6UM FL7PPL-SY:5GI3GLC*YE-I8.77RLKVQ0$FF0:VQ4WDOS1ESZBRT937QD6Z5CGP6 4O$FQ8KHBSD/7E-FD.5RJJLRF1 F3OEFMTRJJ9G6%1OV6WI%N.6ME38NAOKULC7VJSBNRU.OK';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'dob': '1953-03-19', 'nam': {'fn': 'Věrohodný', 'fnt': 'VEROHODNY', 'gn': 'Břetislav', 'gnt': 'BRETISLAV'}, 't': [{'ci': 'URN:UVCI:01:CZ:EPSZDWHTRF82JTS8M6XU77XDBECFFPVY', 'co': 'CZ', 'dr': '2021-06-06T00:00:00+02:00', 'is': 'Ministry of Health of the Czech Republic', 'sc': '2021-06-06T23:59:59+02:00', 'tc': 'Pardubická krajská nemocnice a.s. odd. mikrobiolog', 'tg': '840539006', 'tr': '260415000', 'tt': 'LP6464-4'}], 'ver': '1.0.1'});
  });

  it('should verify CZ_2DCode_raw_4', async () => {
    const HC1 = 'HC1:NCFOXN*TS0BI$ZD8UHJN5IZ9$5WELN0IIR4S 434 JC9BVPIR6D7WCZK9*2D GD/GPWBILC9FF9 RPR-SNH10EQ928GEQW2DVJ55M81AT+M5TDIE54V8C5BSMWQU4DDCEB8C:QI8YUH02.AKU/6$3F06IW9N$*S-CKVD98-O6H34IJZJJ1W4*$I*NVPC1LJL4A7.73*+A0.85MG-ZANLEBH8LJD7ED0-9GKE/.DTNH.HISCAHFEC+GYHILIIX2MCJJPGGPBH8HGBHLG326J3*BBF23K%IE3B9UVQNNJLTM8FC4T*G5G.K*S2U4JM/B3TKJZLF KC9M1EKC8C66C7Q4-G2O%1EX7HO6.S9$B46YKUV46167Q4UYQD*O%+Q.SQBDO3KLB75EHPSGO0IQA20+-C40JIBG1KKQJKM+GHFEZI9$JAM82IAB3FQXCRWF6L/5R3FMIA8/B 04FQJI%KX NREK KP8EFAJL67WY2ITNP8EFPKPS0IWKP/HLIJL8JF1MF172:/1LQ4Q9FQF7 %B$Y6*8O3ORX-S3JTE7LT.EEVV% MQZS313+GL%N1S7G*Z5U1C%RBBK9J%ASBN5+0U6W3ZJMEUZRU2FC69E/T1OMVK20D+SV4';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'dob': '2000-11-19', 'nam': {'fn': 'Novák', 'fnt': 'NOVAK', 'gn': 'Jan', 'gnt': 'JAN'}, 't': [{'ci': 'URN:UVCI:01:CZ:4TYR4S7MW5SCBWCSM4R7UH3RRF2G5HWF', 'co': 'CZ', 'is': 'Ministry of Health of the Czech Republic', 'ma': '1242', 'sc': '2021-06-07T00:59:59+02:00', 'tc': 'MUDr. Jana Vedrová, s.r.o. - 000 - Havířov, Studen', 'tg': '840539006', 'tr': '260415000', 'tt': 'LP217198-3'}], 'ver': '1.0.1'});
  });

  it('should verify CZ_2DCode_raw_5', async () => {
    const HC1 = 'HC1:NCFRW2EM75VO/23WHHW$5- 5OF56$B4OH%DVP*HYC0-ID:2PLMA1:L%/9KUNQZRG-4RJ4:U29O0:U8WIN-69K48BAL9PLT67NOK334/U0NCEQ-1R53PREEQEF$17WJOVRKNSBTDJSIOZ7SIKNO3UJVX5L05Q4Q858W1TNKUJHH7HRP2WTK5JC*M68CNG21*U038CC40NUS+5WBJG+CFDD$M8/KLZOPQN6X.PVI8GN0HFH:7LHZG410-.RV25NV09$A%924K0F81CP1$$D777A9300QL9U0*P91A01T3*AU05ZFK-HV4%IUXF.LB MGT*8L9J6YK503441TCIP7CX06*USG24PPQB9H8F78Z6+K00ZNXT1O+4QE46B0-IEXRCS1HI1M*AH6PGU.86U3X46BP1V2F16D$U8C:F.2ET3SOL1EC8:0HOOHO1R+H44J3FEB1IHZ1M+YAA2IQQUPT9%7O*KU3NQTKO2DNBYTW.FTKMOVSJ25-.FV2S8.C%QR29OH-FA7R-GTHFVM-QB+LAFFGMUH-6CCQ5FP2GEP0W:XNG:VR74-.F';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'dob': '2000-11-19', 'nam': {'fn': 'Novák', 'fnt': 'NOVAK', 'gn': 'Jan', 'gnt': 'JAN'}, 'v': [{'ci': 'URN:UVCI:01:CZ:MKTP5HRWY2RTYQG5BZY737M97APTHMN5', 'co': 'CZ', 'dn': 1, 'dt': '2021-05-11', 'is': 'Ministry of Health of the Czech Republic', 'ma': 'ORG-100030215', 'mp': 'EU/1/20/1528', 'sd': 2, 'tg': '840539006', 'vp': '1119349007'}], 'ver': '1.0.1'});
  });

});

