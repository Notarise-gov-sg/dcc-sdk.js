const {sign, verify, pack, unpack, signAndPack, unpackAndVerify, makeCWT, parseCWT, debug} = require('../lib/index');const expect = require('chai').expect; 

describe('SI', async () => {
  it('should verify SI_2DCode_raw_1', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HLWKA3NX9M$GB9LJ0II2UB 43-KG/EB5E2/HJ6NR*H2Z0P5IBMF6.UCOMIN6R%E5BD7FJ8+YMHBQ:YM/D7JSPAEQMIRYSPEVQ7OPQD1N P$NICZUKSR*LA/CJ6IAXPMHQ1*P1TU1+ZEAW1OH6-M5V:VZM9 $U/E25P2LZUZM9EN9MN9%Y2 UQ1D0 SIWH6 U2-GA*PEVH6/IE%TE6UG+ZECIG$73-E3NAJB/S7-SN2H N37J3JFTULJQAJ8X2+36D-I/2DBAJDAJCNB-43 X45X2DPF1BJ3X8I235AL5:4A934NJ010GQ0B-S-*O5W41FDLDB4*A5Y8+KFMVMH%5QK93N9VQNA346/41A6+Y5QP4 T5%28AOR+L7SA7G6MBW50HO-BP*C6FT5D75W9AV88G64$OSQZR.9LR6T5RI%3J$ZO-FUE14NZSWFE:KA3.1V8SCZCW4B6+E9DVFRQ/XNVBR-WQFY50:UAU56-M4CTTZU3N8416:X71%E/WO0OLX%9048UBG';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Vzorčekš', 'fnt': 'VZORCEKS', 'gn': 'Špelca', 'gnt': 'SPELCA'}, 'dob': '1958-11-11', 'v': [{'tg': '840539006', 'vp': 'J07BX03', 'mp': 'EU/1/20/1507', 'ma': 'ORG-100031184', 'dn': 2, 'sd': 2, 'dt': '2021-05-11', 'co': 'SI', 'is': 'National Institute of Public Health', 'ci': 'urn:uvci:01:SI:NIJZ00000000468'}]});
  });

  it('should verify SI_2DCode_raw_2', async () => {
    const HC1 = 'HC1:NCFMX1/8O+J2C400GEL2JG.8%$AZTM$:0%TS**S L5257$K2 IHLYBD+DZIQ20CY8P0.5RPT%1TN:E*NHGGVC411:CYX2QY8UWIMJPNYBF.RK/2MCEI-1JKU.M65BQ-R6O21$VL2CPWK1NQ912SFSI1HKUW2P2C22SXFW/6WUZRFDW 4G%C1IBP7T2WRKPWGW5O+7VI/A:RCWV5MPB11S03R5ARGX2WFD81H1J5/*K2QO*IN8WCZ2C9H8M43FGH$5LB:9*9JUD48Z8%VH.NG0HBYI2IK4* PG2HU68259 TE*00WA8D+7JZDL.HPT575ALW4 E08S072JNNBT-OBPDI/R.RP9QQJT3003T+N2-C//J:YIAX7DO2DQI7N1V7A DR4E4982280QJRQ587R7ZU4N65+B1P78BAPWSL%LJFC5*8PT1C2ZAUPI/$CTSOXQ2/%MMB75QTIDDB6BEUKE-8HLPF64142H IK/JQY375M4HV.MK0/UEOLJ2B %2-FGDO0LCEY3J59URYEZEWJ/JZ2WF$NN1V7EUJ.0OCVZSFQSOL.SXSO0$U55R+9S 1WK SRVTDQUZTE/BTY+LYZUF+6N-E%8OGCR3/J0 F904JBG.4';
    const cwtPayload = await unpackAndVerify(HC1);
    
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Vzorčekš', 'fnt': 'VZORCEKS', 'gn': 'Špelca', 'gnt': 'SPELCA'}, 'dob': '1958-11-11', 't': [{'tg': '840539006', 'tt': 'LP6464-4', 'nm': 'Roche LightCycler qPCR', 'sc': new Date('2021-06-07T17:24:36.798354Z'), 'tr': '260415000', 'tc': 'Zdravstveni dom Škofja Loka', 'co': 'SI', 'is': 'National Institute of Public Health', 'ci': 'URN:UVCI:01:SI:EHM/TARN89875439877'}]});
  });

  it('should verify SI_2DCode_raw_3', async () => {
    const HC1 = 'HC1:NCFMX1-VNOJ2%20YEET-1Z-1BEIJO25S7WP5A4DF$FI5TSD4V%42OR.1T*9D*JJ*.TBS46C3VU9D/QXO2OMOOJB.LJL8CGREMHV:NC8CHR+IEI4JOV:WV1Q14/V2FUIWKETEDPOC3UO8RZ/P*6P1ZPT:HEGJE77H9M4FVNDF%BPSSFR4EMYDVIT.F60VUWO3*1J0ESCRBU/AM+LW7AVNG1QAPW6D7NS2WR CA3L0-ILOJZDHGF03HEKKQZKIA/HBAAURCQ%S9HAKK8OZ9$NOOCLI I.63-FA:H1 QA.7CAU5STN$GK GN$IN.%38-VO914 Q2Q6VFQMVL%QAJ J/BA+%D*ZL2ZB4D9A4LA1AO+6EC3VS1++O0T5OL80Z1U9D2C4SG6L/IX2VOW15GG PP%%0NSAMI8Z-K5M3LGKKIB+L41EG/PL MBSZAL*8LH3RBEE/0MPFS4WBVG003R877LQMMFC 44II.XPPYQ58U5:QX801CN/K0URRN:63+8RML9CCU6SS25UHUS7W8V2R:FT82Z9VGDW*5NZMC1%Q.7G %SF9VVGT8.BS1C:7OO:F 8FT1D8BVA/M/:KJBS+T3HK1N2U24825TUEUZUR628VV002';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Vzorčekš', 'fnt': 'VZORCEKS', 'gn': 'Špelca', 'gnt': 'SPELCA'}, 'dob': '1958-11-11', 't': [{'tg': '840539006', 'tt': 'LP6464-4', 'nm': 'Roche LightCycler qPCR', 'sc': '2021-06-07T17:24:36.798354Z', 'tr': '260415000', 'tc': 'Zdravstveni dom Škofja Loka', 'co': 'SI', 'is': 'National Institute of Public Health', 'ci': 'URN:UVCI:01:SI:EHM/TARN89875439877'}]});
  });

  it('should verify SI_2DCode_raw_4', async () => {
    const HC1 = 'HC1:NCFQ80L80T9WTWGSLKC 4M79AVRXX96*62$LFBB/S5*70 NAFN0KACHAAWY0GAC UBD97TK0F90IECSHGWJC0FD.34AIA%G7X+AQB9746 G7QB96Y84Y9WTAETA$6B3:6UW6AL6SG6UPCGJCLC9+EDK8F++9BWE-3EAECU34F/DBWENWE7WEN44:+CW7A-JCOEDT34X C:VD$8DB$D:TCQF6SG6JQE.EOWJ3846Y96C463W5Y:6.966G7JL6GL6 $5ZW6%966M64KC*PC.83  COEDZEDRQE2DDKPCG/D5$C-346$CBWEVKE4KCD3DX47B46IL6646H*6KWEKDDC%6-Q6QW66464KCCWE6T9OF6:/6NA76W5JPCT3E5JDKA7Q47%964W5/A6..DX%DZJC6/D/-A04E7%O/ CD:O JC3/DC:OI9ERVD1ECW.CAWEB-AB1AVM8NN9MPCG/D5.CT6A%S9:B8O/EZKEZ96446156G682IS0Z3+FE29LU*47MMW BLEVMW93P9TDU*50L9AY$2UOVRM6DR8FGO4Q3H24MN7- DW9VO631AP-K43UM*J0$NR1*K UB2C959N34';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Vzorčekš', 'fnt': 'VZORCEKS', 'gn': 'Špelca', 'gnt': 'SPELCA'}, 'dob': '1958-11-11', 't': [{'tg': '840539006', 'tt': 'LP217198-3', 'ma': '1232', 'sc': new Date('2021-06-07T15:53:37.259Z'), 'tr': '260415000', 'tc': 'Medicinski center Testira', 'co': 'SI', 'is': 'National Institute of Public Health', 'ci': 'URN:UVCI:01:SI:EHM/TSTAX67554312'}]});
  });

  it('should verify SI_2DCode_raw_5', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HLWKA3NX9M$GB9LJI7245JD 4VSFJ599MJ4DT5B9U+TMMP5VC9:BPCNUKMOFE1JAA/CWVDXCI*ZAVDJG8LKHGL$AG8L ULG8M*CIX+G%KNGKL2HI1JAM*7 3F:H9P1J4HGZJKCHGX2M8FF+G9BYI ILP9C*XI%R0RKJEG35:44$2685$X40YC/9TF4TZCF$W2AWCDZI-XKZ+SF85 WI::S6$4EBFD-48YI5S4CZKHKB-43.E3KD3OAJ5AL5:4A934NJIFT/C3FDA.-B97U: KF%N1FM9.VEN4BLLJ:8%*4 CTJ/3E8AGOJ%ZJ ZJ83B972K/SE.S%QT.ZJZ0K3LICT3BVT/+TWVBDKBYLDN4DE1DPNS56CZ0O4EDZ2SEJHP:EI4U-Q0$-U-Y56TJ%IFAVAI8HP-OS0SPTO2AM2NLMVDU3U6WDINRC3U//M+3JSW2U5E3 VL5V%JT12A3T93H0-*PV4F';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Vzorčekš', 'fnt': 'VZORCEKS', 'gn': 'Špelca', 'gnt': 'SPELCA'}, 'dob': '1958-11-11', 'r': [{'tg': '840539006', 'fr': '2021-05-27', 'co': 'SI', 'is': 'National Institute of Public Health', 'df': '2021-06-07', 'du': '2021-09-05', 'ci': 'URN:UVCI:01:SI:EHM/R987765321'}]});
  });

});

