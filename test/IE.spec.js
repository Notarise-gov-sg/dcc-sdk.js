const {sign, verify, pack, unpack, signAndPack, unpackAndVerify, makeCWT, parseCWT, debug} = require('../lib/index');const expect = require('chai').expect; 

describe('IE', async () => {
  it('should verify IE_2DCode_Raw_1', async () => {
    const HC1 = 'HC1:NCFE70X90T9WTWGVLKX49LDA:4NX35 CPX*42BB3XK2F3U7PF9I2F3Z:N3 Q6JC X8Y50.FK6ZK7:EDOLFVC*70B$D% D3IA4W5646946846.966KCN9E%961A6DL6FA7D46XJCCWENF6OF63W5NW6C46WJCT3E$B9WJC0FDTA6AIA%G7X+AQB9746QG7$X8SW6/TC4VCHA7LB7$471S6N-COA7X577:6 47F-CZIC6UCF%6AK4.JCP9EJY8L/5M/5546.96VF6%JCJQEK69WY8KQEPD09WEQDD+Q6TW6FA7C46TPCBEC8ZKW.C8WE7H801AY09ZJC2/D*H8Y3EN3DMPCG/DOUCNB8WY8I3DOUCCECZ CO/EZKEZ964461S6GVC*JC1A6$473W59%6D4627BPFL .4/FQQRJ/2519D+9D831UT8D4KB82JP63-G$C4/1B2SMHXDW2V:CSU6NJIO4U0-T6573C+DM-FARF9.3KMF+PVCBD$%K-4PKOE';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.4', 'nam': {'fn': 'Bloggs', 'fnt': 'BLOGGS', 'gn': 'Jane', 'gnt': 'JANE'}, 'dob': '1988-06-07', 'v': [{'tg': '840539006', 'vp': '1119349007', 'mp': 'EU/1/20/1528', 'ma': 'ORG-100030215', 'dn': 1, 'sd': 2, 'dt': '2021-05-06', 'co': 'IE', 'is': 'HSE', 'ci': 'URN:UVCI:01:IE:52d0dc929c884cf8998a7987f0b9d863#2'}]});
  });

  it('should verify IE_2DCode_Raw_2', async () => {
    const HC1 = 'HC1:NCFOXN%TS3DHBQGJDMPXRTX19L2CID:D4$X4%CM5V4K7J5DOP-I-CV+%5DOISSLNO4*J8OX4SX42VLFNHJK5I$HWVH+ZE5%PTU1JL84R1*DO6ZR521C-4**4523$737Y4NO2OHL4N8HZA PIC%TS8T:NKIADG8A2JBKMI2OI/$T0-TJZIF:1OK5BD7WOOCU6O8QGU68ORJSPZHQ4ZQ5F59KRFNQ287YOO7ORKOOO1RA-RV*OI875EPID6X*O6U53DO6GBOK5%SM-UD0D9E2LBHHGKLO-K%FG5IAMEADII-GGUJKXGGEC8.-B97U3-SY$NVQ68:3L7F/HS8%MOT63%JN/UYUSC.U1LI//5838I%K/YN-9MA*N1-ST*QGTA4W7DZ7G+SB.V Q5-L9ML1.28XJ4FE1IU9MOAOENBI8KRA74S2D0G1F0Y9 7OZ+E$7N Y1SUS6RT1ZNO6C9E54JUJ$TZ6VT5RQI5RG4C+JO3LL+HS.E/-JP14H7TMFEDJOD40MDLT2';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.4', 'nam': {'fn': 'Bloggs', 'fnt': 'BLOGGS', 'gn': 'Jane', 'gnt': 'JANE'}, 'dob': '1988-06-07', 't': [{'tg': '840539006', 'tt': 'COVID-19 test', 'ma': '1232', 'sc': '2021-06-05T00:00:00+02:00', 'dr': '2021-06-06T00:00:00+02:00', 'tr': '260415000', 'tc': 'HSE', 'co': 'IE', 'is': 'HSE', 'ci': 'URN:UVCI:01:IE:ec0a43b89c984e379493c27aa456c04c#J'}]});
  });

  it('should verify IE_2DCode_Raw_3', async () => {
    const HC1 = 'HC1:NCFOXN%TS3DHBQGJDMPXRTX19L2CID:D4-$C%CM5V4K7J5DOP-I9AVEL4DOISSLNO4*J8OX4SX42VLFNHJK5I$HWVH+ZE5%PTU1JL84R1*DO6ZR521%*4NO2+LPJKKS1JG%S-ZVMHFIFT.HBRZIN%2+T410T5HVJG7SER.MP/*3M1M0OPU98$NI4L6YO1%UG/YL WO*Z7ON1N+L-$B5P1HTIRU9UQIV-H/ZPEX9ZGABE2YY9DV5IQ1.J2%T58 9WYHW*IVLI2UHN-8CZKHKB-43.E3KD3OAJ4%I7ZC/FJBAJULJ323.T4RZ4E%5B/9BL5RTEUNUE2FH+9NVPWSEAKPL0AL+9P8QTF9/NE.PEQK91R9NK9HN9G%5TW5A 6YO6YL69/9-3AKI6-$MQ50 JP4POAXBZETG2T%DE/0VZ/R%6HI$857J-6Q$LN1SF0LN1AG:NSCK811H507G-VJV48EV%ZIM36UBI9JRGIK:DA%*PZ0MWV42*P$6VZU9961X1RYIF';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.4', 'nam': {'fn': 'Bloggs', 'fnt': 'BLOGGS', 'gn': 'Jane', 'gnt': 'JANE'}, 'dob': '1988-06-07', 't': [{'tg': '840539006', 'tt': 'COVID-19 test', 'nm': 'NAA test', 'sc': '2021-06-05T00:00:00+02:00', 'dr': '2021-06-06T00:00:00+02:00', 'tr': '260415000', 'tc': 'HSE', 'co': 'IE', 'is': 'HSE', 'ci': 'URN:UVCI:01:IE:1eb24cba367a40e0ae559013ad87523c#D'}]});
  });

  it('should verify IE_2DCode_Raw_4', async () => {
    const HC1 = 'HC1:NCFOXN%TS3DHBQGJDMPXRTX19L2CID*F4%%5OGIR47HY6:X96HC5%G3XHW2KK1JZZPQA3DP4OW631A C5PF6846A$Q*FMSW6EN932Q0PPZW4Z*AK.GNNVR*G0C7PHBO33MHFUKB3838J3 HBHQBS+KJKB9S4+/4PXK/EB23LF.KGP4K8LH23583XXV3ZCR:4-Q0M*4CZKHKB-43.E3KD3OAJ6*KMB8S27UW631A9D9NZUPS5 WUQRENS431TBYK2RV:WNV+0Y/K.*K$2TY8LW-28ALD-I.8FFVV%*4 CTM8F57TO*47*KB*KYQTAITNS4.$S6ZC0JBZABDG34LTDBJ767NI6B8WHD7EIUR3C/KO%ODK/HID7MUTUYONQ5.4LI61KQ3WX0Z9PGFVSWDN8K 5DF/TQ5EV.SNPQ**V%SBVPKU38Z7R%FML:IQ2KTI3S002BSR4';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.4', 'nam': {'fn': 'Bloggs', 'fnt': 'BLOGGS', 'gn': 'Jane', 'gnt': 'JANE'}, 'dob': '1988-06-07', 'r': [{'tg': '840539006', 'fr': '2021-05-17', 'co': 'IE', 'is': 'HSE', 'df': '2021-05-28', 'du': '2021-08-26', 'ci': 'URN:UVCI:01:IE:f1c118c9fd994b7c8e28eeffdb3f41b0#N'}]});
  });

});

