const {sign, verify, pack, unpack, signAndPack, unpackAndVerify, makeCWT, parseCWT, debug} = require('../lib/index');const expect = require('chai').expect; 

describe('LU', async () => {
  it('should verify LU_2DCode_raw_INCERT_R_DCC_Recovery', async () => {
    const HC1 = 'HC1:6BFOXN%TSMAHN-H+QC3W9ULE $HXOE/R8MF6NDC-QU $CAH98%MP0K4G500380LNO4*J8OX4UZ85XPWLI5UPWS1Q$F-1VFXFFZFPYH1O4EUOKK4BWIG*F:PI0IGIMISSQWVHWVH+ZE5%P4W1IMIWG9$R7AN89M4: KNH4FZJTDCZ.CZIIQ8LK3DH69*ZK1AOPMGJVLK2AX090D9E2LBHHGKLO-K%FG8KES/F-1J3.KELN/EGV6ASKE MCAOI8%MPPI+NG+M5VM6QRAVWEYO9MN9DSHMN2/TU3UQBOH-GA:YU8I0CPA+LHAW28L2JMILRETHGUSH5J0N*J8%FV1W-VFXQGDVB3VF+4WCPI2YUBOH1TBV1WWC0: BRLG%$D+W3OYJG*FUVPQRHIY1VS11O1DS3ZUH.YNL2GY*FEX5BFMA/V51JU3TLL1Z$94XN%5UVWLZ8N/$BMQ33RPT:U/67R.A3T27+SBSVBAUSVK0%UGMRPW0CVRB8OBZ5K23F+18VTF6F';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'r': [{'ci': '01/LU/2MRMF23YGV9XH#1L', 'co': 'LU', 'df': '2021-06-12', 'du': '2021-11-28', 'fr': '2021-06-01', 'is': 'MINISTRY OF HEALTH', 'tg': '840539006'}], 'dob': '1967-03-01', 'nam': {'fn': 'Spécimen-Mustermann', 'gn': 'Jean-Pierre Marcel', 'fnt': 'SPECIMEN<MUSTERMANN', 'gnt': 'JEAN<PIERRE<MARCEL'}, 'ver': '1.0.0'});
  });

  it('should verify LU_2DCode_raw_INCERT_R_DCC_Vaccination', async () => {
    const HC1 = 'HC1:6BFA70$90T9WTWGSLKC 4089DQ3.5LOIMW-J/AB0XK9JCTXA2F3GROS2G2F3DNNUXUY50.FK6ZK7:EDOLOPCG.E 96BT9L/5P093H8CIBG69J1AN57BK4%N9UPC9JCXZAFVCPD0LVC6JD846Y96B466W5B56+EDBKE1C96C9VTA1CB:0AT34:X8AT9Z69B$D% D3IA4W5646946846.96.JCP9EJY8L/5M/5546.96VF63KC.SC4KCD3DX47B46IL6646H*6Z/E5JD%96IA74R6646407GVC*JC1A6W473W5Q471A6TPCBEC7ZKW.C8EDMBESILYED1$C JC2/DAI9CEC1/DLPCG/DM8DT6AZM8QY9.+9I3D8WENH9NB8C+9$PC5$CUZCY$5Y$527BGJJD*70HUQ/B.8P44HTBCU+E.B4S7L TN22IBTQ4S882PD+DB8UF0KURUBFF$M3M1JTVJ 0J*X4D8O9GNS*PS+1QP4JNN%VB./K9YE';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'v': [{'ci': '01/LU/1GJBHZ9HOOZ8W#3K', 'co': 'LU', 'dn': 2, 'dt': '2021-05-30', 'is': 'MINISTRY OF HEALTH', 'ma': 'ORG-100030215', 'mp': 'EU/1/20/1528', 'sd': 2, 'tg': '840539006', 'vp': '1119349007'}], 'dob': '1983-08-19', 'nam': {'fn': 'Spécimen', 'gn': 'Jeanne', 'fnt': 'SPECIMEN', 'gnt': 'JEANNE'}, 'ver': '1.0.0'});
  });

  it('should verify LU_2DCode_raw_INCERT_R_DCC_NAAT', async () => {
    const HC1 = 'HC1:6BFLX1W08$$QDO319CV-K.TJL4H6CM9NGM3W0:V 4MTDQEBS93BN-U1Q9:Z3//PI.7TR3G9JQUU1:JLW5H6N.2MRAH $1QNN0-2NHE.E8374L75R%JF.ODS3I%V.+F6NUKE5 5D04A88V56JR9N7.N2QA*:93US7O6C4VSZQFOR4WVFLR2Y1O%O3G6I-SQ$F1UMF48./B39CEDR :6.1BIC4*-H9C7971F/HIJPTMSDLGR.5$CR:+IQTRF/H+*M-CQRD74DC4VCWXAU+QZDNJ%R2UICL9FTISG9PXESHGN841L8-LKYPH* F1QTXWBVH5G5PO65DW8XU6$PMFTTH2PB15B89OU8AGBCR0T6DEFRYLHGANFR8G00L95H%N.*DS1L:PQ0T09DKT$FPI0QI0RGF*3A4ZB$TFZ5H8QJ$XHW8WCMIC$S.9T.:SAGJRXB/-C941CUVSCKZ79F+E3YT5BN.YS.OTH+NA7H8I2-U6LHA3OCC9D+L7ZP10XQ:F8ERFLQIJ2HMCCZ-DO/OO6O YN$KVEJ8D26 5IBHR19P:TIP S85U2WOPT6L$16CO:XT3*58EW83GEYMI:9OLF$NESGP /3D-KAOVFEU8OVP1825WM0PJGI';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'t': [{'ci': '01/LU/3RD8KQOFR123Q#1E', 'co': 'LU', 'is': 'MINISTRY OF HEALTH', 'nm': 'Allplex 2019-nCoV assay', 'sc': '2021-04-13T12:20:00Z', 'tc': 'Test Utopia L-2551 Luxembourg', 'tg': '840539006', 'tr': '260415000', 'tt': 'LP6464-4'}], 'dob': '1967-03-01', 'nam': {'fn': 'Spécimen-Mustermann', 'gn': 'Jean-Pierre Marcel', 'fnt': 'SPECIMEN<MUSTERMANN', 'gnt': 'JEAN<PIERRE<MARCEL'}, 'ver': '1.0.0'});
  });

  it('should verify LU_2DCode_raw_INCERT_R_DCC_RAT', async () => {
    const HC1 = 'HC1:6BFOXN%TSMAHN-H+QC3W9ULE $HXOE/R8PJENDC-QU $CAH98%MP0K4G5W03O/4F/8X*G3M9BM9Z0BZW4+/IX63%ZV QTNMBMTJHKBQW0COVGRV9P5PPFSZ4UJ0XW4UZ2BOV-TV6$0DO0KJ5XTNYBFNK7RXG+T4**4/43RA3CP4A05423423ZQT+EJKD37$GM33UFGVTA$C9U%GT58XKCZH84D92C8YOKXMG43M8KL IKY1A+Y8R.D6:FNDA5IAXMFU*GSHGRKMXGG6DB4C9X:KSEQ0N86H0+SG$NI%S5Z00WN8$M8TJ1K SP$I/XKP64IABXDOXCRWF6L/5R3FMIA1.BKBEENS*LP9LN:EF9NTJEDLJL2GF+KL1FD2V4:HOK4M33KU2MTNP8EFJED13MR:FF4MF%CD 810H% 0NY00 1+-79/MWGB:N0I6HMXV816T:NDSB2X5S9KTBI7.KF1F+4HH-158PM*1J8B49G:SSU4V58W.ST36LQO733V2MRM%R-RM0$7DLLESUZN2ZX0:PF';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'t': [{'ci': '01/LU/18O5I86QFOIMS#OJ', 'co': 'LU', 'is': 'MINISTRY OF HEALTH', 'ma': '1604', 'sc': '2021-06-02T00:00:00Z', 'tc': 'Phar Utopia, L-2551 Luxembourg', 'tg': '840539006', 'tr': '260415000', 'tt': 'LP217198-3'}], 'dob': '1983-08-19', 'nam': {'fn': 'Spécimen', 'gn': 'Jeanne', 'fnt': 'SPECIMEN', 'gnt': 'JEANNE'}, 'ver': '1.0.0'});
  });

});

