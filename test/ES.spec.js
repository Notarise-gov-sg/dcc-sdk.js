const {sign, verify, pack, unpack, signAndPack, unpackAndVerify, makeCWT, parseCWT, debug} = require('../lib/index');const expect = require('chai').expect; 

describe('ES', async () => {
  it('should verify ES_2DCode_raw_103', async () => {
    const HC1 = 'HC1:NCFOXNEG2NBJ5*H:QOS/O.+NEKBS7LOMD7LGT.8+W4VGACUL84QOGIVER%18AD6E 6 NI4EFSYS1-ST*QGTA4W7.Y7B-S-*O5W41FDZ*GCEFTFHP+KREHS469JA8/BIQEBDA5KDOKEH-BOJKS7K2TK.9DQRKUYH:ZJ83BV8TR634$TM7J5OI9YI:8DH:D%PDGZK5WCDAB*CNAHLW 70SO:GOLIROGO3T5ZXK9UO GOP*OSV8PS4V776K82HPPEPHCRTWANDOT*ON*O2HPJSP/88N10%*4GR2UFPM.KON1*JK1W4/GJI+C7*4M:KZ34MLEOXIE:F2C8LC9D:H+7BNDAOLD5H88LDBH882G1OS7NV0OPI98J%44$2X49O5L+*IL%4Z7TTYNOVAD12OWCSP4*2DFDPU53XY0N43W9BW9BA93HKB29BHRJGHJZ23VEBOLN+HBAM7947WRM5EP B5D6AHVJ2KN.QMZ17D-N4QLX2N+5KR4UR+K$%CODIWLDLWFK/V1+G3:NN+0LP7N P-6S*4TZT7PT8*4WLX5QLF*I5YUT3H0TDQSBH';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Andaluza Andaluza', 'gn': 'Carmen', 'fnt': 'ANDALUZA<ANDALUZA', 'gnt': 'CARMEN'}, 'dob': '1974-02-28', 't': [{'tg': '840539006', 'tt': 'LP6464-4', 'sc': '2021-05-03T14:20:00+00:00', 'dr': '2021-05-03T20:00:01+00:00', 'tr': '260415000', 'tc': 'Hospital Virgen del Rocío', 'co': 'ES', 'is': 'Servicio Andaluz de Salud', 'ci': '01ES01T8D8F19849772480B86DE8#C'}]});
  });

  it('should verify ES_2DCode_raw_1101', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HKTGX94G-ICWEXWPGEH9M9ESIARG4YK56C1FP8%V79FKXTMIQ.-AAN9I6T5XH-G2%E3EV4*2DFDPU53XY0+F3OA7%BBHB36475UNNJJ4DJ-L7MD3VNNP6BSRJSZ49K0B69UKPSH9WC5PF6846A$QX76QW67Q98T5I9IX*9KI5.V9L$P0BEL35OK9IY9RZN81CHW4:84LC6TQ6L95ED60-RQC25NIWJ1N%LLR2A KKUE$5MV*4WZJ$7K+ CMED ILX9C.PDE2KI7JSTNB95F2699RS35A$QWG9KIRJCQNUO%E53X7V.QL+QKVQCA7T5MN%4HK04T9P8QGIG02J$%25I3HC3X83947IJMCMD34VFEHEQI3GKI:0/PE*%5YNL R5EG7$YTRXNZ O8D4025:XBBP3.1DFFF*LH/PVY FT/S%.IO7OP8NQ$7SGONUAH266KTFQ78.09PF';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
  });

  it('should verify ES_2DCode_raw_102', async () => {
    const HC1 = 'HC1:NCFOXNEG2NBJ5*H:QOS/O.+NEKBS7LOMDQMGEBUKHREE26ESD PP-I4GAFM6/MI3CMNO4*J8/Y4F%CD 810H% 0R%0IGF5JNBPI.QUHZ3+GA*PE9SLRV24ZHC.U/U6S%OC-RQ*N8%M2MIE09J.279K6456J3HK4-Z7GT4QKRPHPZ.Q4A7E:7LYPPTQSV8*DOPCRGH4BDL8FF0D9E2LBHHGKLO-K%FGMIA6EAYHILII+:L38ATDC-JE1EQVD98-O*OI/HL:$C*LPRMV6M9EIAGW2:GGRZI5XI3CNZO8C KHHA08QI9D1JAA/CFZJDIK5EM1FCWVMNUK6JK%SHNII:IJBHH0UJAVKTTJCWM6QCHP8O9MJKQZY2V-T*OKKH8/%2EKV2VDTTDMAI%%AGLAQ*QJ%R+NE5JTBO6IYQS:L6EIRGE/AOY7N9%NEIBU$VEPSWPKLMN3 28G3A 40108CUP5';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Andaluza Andaluza', 'gn': 'Carmen', 'fnt': 'ANDALUZA<ANDALUZA', 'gnt': 'CARMEN'}, 'dob': '1974-02-28', 'r': [{'tg': '840539006', 'fr': '2021-04-01', 'co': 'ES', 'is': 'Servicio Andaluz de Salud', 'df': '2021-04-12', 'du': '2021-09-28', 'ci': '01ES01RC6A212DD2A6140F2A3F0C#A'}]});
  });

  it('should verify ES_2DCode_raw_1002', async () => {
    const HC1 = 'HC1:NCFOXNYTSFDHJI8Y0PO%K7ING/0B71G.2AI6O:5QR9AV1OGIU-QOMOF9V0OUH5P/5OO$DK1JZZPQA36S4VT6SH9X5QFAIT567U10Q6JFEA0FV9EZ ERW6J.EA7N.Q6S*E746M$E$%6PK9/1AVU1+G9EPL.Q6846LEQ*FMNZ6R11:667C07ZD$J4VIJZEB9VCMCI7UJ$JC9VCYGIQZJX$KFP1W D7LE-+9DJA:CA4D93DAS/F0D9E2LBHHGKLO-K%FG5IAMEADII-GGUJKD70KDC40JIBG1KKQJKM+GHFEZI9$JAYHI5GKT*OB-S-*O5W41FDZ*G9W0OA7EGJYLVS469JA8/BB3CR.D7DAOKEH-B5IK:BGV6I68L*6OUYH:ZJ83BQ8T*EU%S26NJF0JEYI1DLNCKM52YHP/REG J YT3GSU+F80VLZ6X:39 7OKK:GEHUFO3NNE9EZ0 *C+WLGBJ17W9KU-/LSG7TGD%7K1WQX2Q1 4YT0SGEJHEMGBL+I.XNG*JKDTVTRPXTZ0SLXK*1K* VPOV4FN11S$K1QZTZ$5NBQ3MV3O6+VQSRER4GPFO:E9N2R94F 6Q3S3A/UZFUR*7C:MJZBXE4*WN0Y2I-TORT$54LQ5-:OJK7VUHA$Q1*31SCHMN+ALU0V33OU52IL2JW1O-TYMDHNOW+7*O6Q9N/:UJ B8:V*WQZKQZ6NU1OMLQ2OSGF4GSVWX8:$OG J13TS-BN03LDL4QA5D4YZQ 5QM1CJT9XY3RCLYTA23KF:931SCL2P.H6Q3WFJ T75ABQIQ3*OSER9NVKWG+ P/82JBVR20L*CR2';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Apellido Apellido', 'fnt': 'APELLIDO<APELLIDO', 'gn': 'Nombre', 'gnt': 'NOMBRE'}, 'dob': '2014-08-16', 't': [{'tg': '840539006', 'tt': 'LP217198-3', 'ma': '1218', 'sc': '2020-08-16T00:00:00+02:00', 'dr': '2020-08-18T00:00:00+02:00', 'tr': '260415000', 'tc': 'laboratorio', 'co': 'ES', 'is': '10', 'ci': '01ES10TACD8BEE543F79125E845E#4'}]});
  });

  it('should verify ES_2DCode_raw_502', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HNTKO+GVNRJAW8BW/R8JF6NDC$IEM/CNOPRUM%0D.0UGN8BURDAKP:P:ZH6I1$4JF 2K%5PK9V L9L69UEC%63U1EWM$DMUJEWW6V566LE/G6HB6%*6NWEK+A0T932Q6G39ZIQ0J1VCSWC%PD:NK1ADZXI+G1 73IFTL6B6*K2NOON1HRIWQHZVCCPACPPIRI*WU+WJ WURSHPVEQNLF.9/H8BJC:DD5IAXMFU*GSHGRKMXGG%DBZI9$JAQJKEKNK3MM82YQE.-B97U: KC$NT:6M9TW1AB2A1U0V24:6TLZI99J6%TAVT%JT/JT08KC0JED096C0EA:ZJ$2BQ KFT5D75W9AV88G64ZOS3+8 BW5L5++T+9NS8W5ET*1VVRF7LRUCQ/6G%LDQ.AK2C$.D/$FRKSGDRKQD6OP1+C +P+Z8MBW5M33%U$XES*P RA43B43KD.Q-40*TVQ3';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
  });

  it('should verify ES_2DCode_raw_703', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HLYS/%QT5NU9NMG9/R86 2NDC$IE 0D.0UVYOOOAPAWYFFJ78T5TE5RMDOK1JZZPQA36S4VT60T9X5QFAIT567U1I36%KMJS63VEN4F5O6%XEQ MJ%6M4FZNM2QE0/EPK9I+0PTIGIA3A41VCSWC%PDMOL27DTJCB6C3/8VZ0958AC5ADN/8QQ+MPW6IA7OBAX357X7K:7FA6P84DYAU4796L W0+8EFQ50NP4KPRVA9XATB9ZZN616647I7K/Y41V29-3$+OAGJT681ZJ%J6WH6*WU*K8/I6QJA.MH2JC.KJO34XTOWEGJ4LGBTB0LM9DJFRUZ4+FJE 4Y3LL/II 05B9.Z8M+8:Y001H%Y0XI09H6-F0+V9.T9D 9PRAAUICO1/T19UE2YHAT1UVI/E2$4JY/K3:SZK7WT0KZ0*XV6HV4$0ADF7Y4 CTNK7RLN1SV6AL--I-W4D54TNP8EF47AMDKZGA2:UG%U2E46XGKH2%4C+ULTGPHVV38B9-9ERAUZT0XG5SF+-TF:KDZJ2OLZSNAAL+8JJSHIRB4FUW-TSOA.AV5UKH8K1CTB-56MRN.R55OMI7 6D140ASQO3';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'CARRASCO MARTIN', 'fnt': 'CARRASCO<MARTIN', 'gn': 'ANGEL', 'gnt': 'ANGEL'}, 'dob': '1918-03-01', 't': [{'tg': '840539006', 'tt': 'LP6464-4', 'sc': '2021-05-14T00:00:00+02:00', 'dr': '2021-05-14T00:00:00+02:00', 'tr': '260415000', 'tc': 'Hospital Clinico Universitario de Valladolid (Vall', 'co': 'ES', 'is': 'Gerencia Regional de Salud de Castilla y León', 'ci': '01ES07T895AA7BF69D99C77DB96B#E'}]});
  });

  it('should verify ES_2DCode_raw_702', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HLYS/%QT5NU9NMG9/R83LHNDC$IE 0D.0UFL41PA$DH+$5W34N$U:P0O45AN9I6T5XHMF2CG3V.4*2DFDPU53XY0*9JNJJVC7R577E3CDB-43II7NF77E3WC7-F7SRJSZ49K0.B9 E9PF6846A$QW76UW6SH99B5VRUX%EPS5XRQ%GS5$0VD98-OFOF/HL5JL*LPREHOD8-NTAOVTFH C1TGL0LO.C7/85*:G1KCPC9L+93NKP-KS4APOS:EFUZ4+FJE 4Y3LL/II 0HJP7NVDEBU1JO5PSY0CNN$3LIGF5JNBPIZTU8.R+2W3R30WBUS2 Y73VFWQG/V7BPI3$U3R3COO%UG/UIGSUOESHYD6F1YZQ5I9JI599G7J6YO67N659EP6UADIKVI8+T+FA$YC.6LE GT-QQ I17V. PO:T5/LP.SV-VTIOJML4X4PJDN1NW8V WVT5FRZR6$8*QM4DSSYAK65 $AWGMKIMTY1SE24LG';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'GONZALEZ GILMARTIN', 'fnt': 'GONZALEZ<GILMARTIN', 'gn': 'ALVARO', 'gnt': 'ALVARO'}, 'dob': '1993-08-05', 'r': [{'tg': '840539006', 'fr': '2021-04-01', 'co': 'ES', 'is': 'Gerencia Regional de Salud de Castilla y León', 'df': '2021-04-12', 'du': '2021-09-28', 'ci': '01ES07R6FA4C90B8805C5B10BC5C#5'}]});
  });

  it('should verify ES_2DCode_raw_201', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HDQC8RMIZR4QBVVH:D4TEB-36QHN-XML0FYA2AKM/LMOE5*CIZ+C$QPYTTCV4*XUA2P-FHT-HNTI4L6F$SFP1OPGFYHU%PS-JA$PJR3GQ3RP5KW1O$R2X5Z1S%%PD 9:PICIGLS4AZKZ73423ZQT-EJMD3LS4JXITAFC%0:Y0SC9EY8V976YB/VMP+PTF11JSPPKR+PD%P:+G/PKV/UA*NLKC$XIY%GK29L8AA KZ*U0I1-I0*OC6H0HXMP$I/XK$M81OA6YBDI1PK99Q9E$BDZI05BX1JJSBP*Q4BLX1JOTI3DJZ3C0DJ92KU$3 VB-8BZIJ ZJY1B8.S6LT*USY.T37DS8TJ S/JTL148DJZ0KBLIOD3XQTB.SYBJF0JEYI1DLNCK162I56:WN PUWSF-I9S*93U9+ VFXAL8NNPHKV4B13Z46HOT4:RA28Y7UTTDMIE3CVLGI:F77RVI8JZ-N:9QPPPM/21*VQFO4-EZFEWMKZ10D AX1';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
  });

  it('should verify ES_2DCode_raw_503', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HNTKO+GVNRJAW8BW/R81H9NDC$IEM/CNOPRUM%0D.0UGN80KBD RJ-BF/8X*G3M9JUPY0BZW4V/AY73CNN:L3W0H7DJHTN5J74LBW9B*DJ%KNXSJNQNVGJAK5EV499TX%HKK9+OC+G9QJPNF67J6QW67KQY466PP33M.71.V5OVPK6QJ2BC/9TM92G00C57D1REH0LO.C7*95MKN4NN3F85QNCY0O%0N68:0LPHN6D7LLK*2H9-89UV-0L/:IS-O:S9UZ4+FJE 4Y3LL/II 0OC9JU0D0HT0HB2PR78+FFZI9$JAQJKEKNK3MFB2/5O*%NH$RSC9+IFD:DT2QJ3KM4K2F1H58. PR95326SKRJ+QGNQQNQU:7+Y5SQ0ICOEMKSA7T5M$B9UDBQEAJJKHHGWC80J0.5PDYB8 RX3G+5C.ZD8AM2TS $PP5TAX0A:RR1G5BMF7QEIDI.7CWTZCWZI345RHJRO-8MXRU+4Y7O18G%PUA*EXL5R5BL FQ65N01V4IG8G';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
  });

  it('should verify ES_2DCode_raw_2101', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HKTGX94G-ICWEXWP769 5W3XH74M6R5J711MG*CM+W4967RXQQHIZC4.OI1RM8ZA*LP0W25$074M9-8YC8O.CP-823L*/GF/GD4T9-8+5TW$5X4PDOPYE9/MV+:T.A53XH395*CBVZ0K1H$$0VONZ 2ZJJ+.K4IJZJJBY4.Z8YLV0C58G13HHEGJDFHIE9MIHJ6W48UK.GA68$8D7AD:XIBEIVG395EV3EVCK09DEWCFVA1RO5VA81K0ECM8CXVDC8C90JK.A+ C/8DXEDKG0CGJ5ALR.4YMR$ZJ*DJWP42W5Z/6S:7Q+MX4CMBNXJUH.VI%K6ZN7BM1US4K5+WJDSH TU/UIGSUJLEH-V: B1-V-VF+4WOUKYZQ.J9 0OERGP%D+W31 FNSGUVPQRHIY1VS11O1QR3*V0Y/FCV7*7L-P9C94HHVCEE.ETSO9GFS5RAI-96HU PV22P6Z42*1E1BGDN51A6STH3S1CO488O:RV%EW07%$5*2OQ*VQ3EOWBYM0WHC24G';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Romero Muñoz', 'fnt': 'ROMERO<MUNOZ', 'gn': 'José Carlos', 'gnt': 'JOSE<CARLOS'}, 'dob': '2021-05-28', 'v': [{'tg': '840539006', 'vp': '1119349007', 'mp': 'EU/1/20/1525', 'ma': 'ORG-100001417', 'dn': 1, 'sd': 1, 'dt': '2021-05-28', 'co': 'ES', 'is': 'Ministerio de Sanidad', 'ci': '01ES21R1662955121D74217FDD39#0'}]});
  });

  it('should verify ES_2DCode_raw_1003', async () => {
    const HC1 = 'HC1:NCFOXNYTSFDHJI8Y0PO%K7ING/0B71G.2JS71ROGO2D PH-I$ZVJ/J5BN4W1$X0S0NK1APF6R:5SVBFAB4DNN95ZTM86QLEQJIRM64P1R/HQCIR/ROQHP5NPPTQM0Q0SO40P-88L35UA7TJPM47MV4DYP+GO6W9XDOXCRAQ55*K-DPDH6HVUCNHYGFF.OK.G5B9-NT0 2$$0X4PCY0X:CZD50B94/RM127LPMIH-O92UQOC1IJ1YQEDG68RUB9CI%KUZN8CO9+REQK3-SY$N+J8.102.3.:943GE23SA7G6M$0QIDSVC5SZ6FT5D75W9AV88D542HIWKT WTH5KL14PW7-PVY1N*0U7/IGTU2VPYZ7NXRKT66.TSG1B14.I3W1U/V7A:C1DQNHUTKNZFVEQEU3O$*QLFW8OE+$K$9TLFNZ76D+QZWRQ:AQ U.+RMPG%$6IZP5 T-KPAJQ/8OK*BKED*MAHYLK8K05E4LA9-TI*2H6V/S7FMS6MM5YE0FOE$CV O8-J8*PL$FT*TPGC*OS.REB5E2CO17F1VOM 7922GZ7T4O JR0PAOS6103X5576TD2R.Z4E-SWNPD 10ZBKWJ43K$AE05EZDP1/LZBTMVRAB1KR5$OV6YQVOPLQUQ/UN:7*TNMI5EII6N201VAPIYLT/-6JMK*8R85S3.BEKRCLFG5MHVJ:QHUP3G$D/F4RHUKZFV1R%KNALM%-GW:2*011%V:P6L00FZ4W2';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Apellido Apellido', 'fnt': 'APELLIDO<APELLIDO', 'gn': 'Nombre', 'gnt': 'NOMBRE'}, 'dob': '2014-08-16', 'r': [{'tg': '840539006', 'fr': '2020-08-16', 'co': 'ES', 'is': '10', 'df': '2016-08-16', 'du': '2020-08-16', 'ci': '01ES10REC193B8823BA97F084DD0#2'}]});
  });

  it('should verify ES_2DCode_raw_2102', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HKTGX94G-ICWEXWPX9H9M9ESIARGHXK*+D$055B9TUDP0J-MPW$NLEEEJCY S2%KYZPF97.P8-6C2UODM8-K6NN9UNARK4I/2*I2WN8I/6S-2-N9:WO$*SVFKC K:YM8J4RK46YBBOA3O8C KUGAACQ*883DO4C5K11P4D%PDS1JGDBTTTYIJGDBQMIGZIY8MGOIM423DJTIJ/CJ5VA81K0ECM8CXVDC8C 1J5OI:N0XHQVE4L/5R3FMIA9.B-7A6/D1FA1MGNPTU.H8ZA9NTGB7-PV.4H8F5G.4$2TW-26ALW.IDS02$VU*0H R*2H5NV9Y4KCTSVCVLVUXN+47U*00GVA057*KB*KYQTHFT4S8$ZG:SU5JUZDFSM7HMPF8V0FWM2A:EDE$KXYK/RRD1G79L7$OWLGY-QUGLESDN0UZCCR657673OVW-M7AUV7UIXRQU1O RHBO%6SU F%40IR485';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Romero Muñoz', 'fnt': 'ROMERO<MUNOZ', 'gn': 'José Carlos', 'gnt': 'JOSE<CARLOS'}, 'dob': '2021-05-28', 'r': [{'tg': '840539006', 'du': '2021-10-04', 'df': '2021-05-10', 'fr': '2021-04-06', 'co': 'ES', 'is': 'Ministerio de Sanidad', 'ci': '01ES21R1662955121D74217FDD29#1'}]});
  });

  it('should verify ES_2DCode_raw_701', async () => {
    const HC1 = 'HC1:NCFWZ8P8QPO0J40 UJAMV+57GNHJI6-EU35Q+EFNHFD 0$JL0Z4CHDW*V8TDA2U2SCBY58POIJNE4QCRFDJSCCK9+J8P3R$6G0I*Y84X3S65UBQM+7.ST9/MANL7/J3OS66R-0QAWND:K8Q1DIDSJIA7E39RCHK4YP/6D/FL.PV/JF M4GNTYIL$9WHC4:*JKL3%MMXMFXR44SI-F8:X8YC2.KH5QCK79F/TKV8H+06MC522- NDP2+743N0/89QB5QGV*SE5$KAVKIMHFN7AQLTZLIQML4TS83-DIQNHNZS.E3V:C.+PXJ2OKEB.DBC3224O24/ZGXQ4BCETIP/WH*9815PED2TD3NUSS/H%AGDN1K24Z9O: G:OK%42Q+32GP$Q5II4350W64YJL8SLZQHE%K1GVV*APDB+YAR:GWCMVUDX7KOZQWQ1DPO6I3R+2T8WF4SGE9-LL7TD:6WD:FN*0F8G:ZQ/SMDY3KYO*F5X5E$BQZPE7:RVTLN7WX4UWVQD4V3QR-4G3-N5KA:6RHRPMWF2/5GYR4VN5ZPL+8ZQV99W8PMDGL$*VJ%V.4I';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'MANJARRES SALAZAR', 'fnt': 'MANJARRES<SALAZAR', 'gn': 'BETTY MARTA', 'gnt': 'BETTY<MARTA'}, 'dob': '1960-01-19', 'v': [{'tg': '840539006', 'vp': '1119349007', 'mp': 'EU/1/20/1528', 'ma': 'ORG-100030215', 'dn': 2, 'sd': 2, 'dt': '2021-04-08', 'co': 'ES', 'is': 'Gerencia Regional de Salud de Castilla y León', 'ci': '01ES07V89AC8B666484995C3F941#D'}]});
  });

  it('should verify ES_2DCode_raw_202', async () => {
    const HC1 = 'HC1:NCFW A/8O$$QPS3O91WKHNVNYQGQI1/BD3KVW4JP:NPMB2+5MMCQWDIN9H3UZPF0FDU:L%F0. UF5A X0.2C-AE.LFV6AWEE3%RGHTJVI/HSOR2044C62 ICBJHL6DFKU.M69CESHL7N714WP+PV02RC9/TFFIB2SQ4/3F-Q6T7B+UTTU+XF%$B 2SCNEPNQ:U74+8P3U7L6IOPZDGN32%S843IJM2TQUT1LS/54/75X9S+CGXSZ*I.EEC3K:9G X3%H7B11L-289RP5ME-ERAJ7QPZEJKP8A 8$XQY2LQR9YX7D-ULZED DEBKZNO .CIBEMM9JSLX6E+:CT0MZ:84HLKX4SHC-EW9:1A+C%WT++51/8EFQY$KQF43%Q6OC8V23J2GTOTEMCOPU4NFR8R J0MDXYQU6D$D7JRNMYS%ZD2BP+.9T8CKA97N4$A4YX2XYA5R9D:D-V1T%LG%5J*CU261LQF9AS94FHML9FJES$WCUYR9.C$O59HU5QL$14FB9 44ZEJP81748$-DCGWSUF16C:0GB4V%+R2%V2RAKWR1:208IZ+J7ZM6CO:+EU7IW/VV.OX$VNYORSG6EU-OUSA0%TV463I4WOO7NALI4PZ5J-7RWAW7OC85J';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
  });

  it('should verify ES_2DCode_raw_501', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HNTKO+GVNRJAW8BW/R8B%6NDC$IEM/CNOPRUM%0D.0UGN82:CS4PRC7:ZH6I1$4JM:IR1MPK9V L9L69UEC%6+W1646W*6X*6V E:96L.EEWMJS6/G6VJE8 A0T932Q6G3ZXIRSAPEDG8C5DL86CQR8T0HH*APZ0IZKE6C3S4OH6%L5ILGBUHWH6OP6.W2MN2MF2YAGYJ99H83NKF9E3-9 H9/.DTNH$IISCA9.B9+G1PCDJAFD9BH8/ICF/CALGK.C6LFE:FPC9LMED:HC687+BZCPXBW.:9PZBZL9U9P$*G3-QAOI-RSET4S%H:O1D.L*FI0:5. 5D-PEKB3YI-XI-KIXQM5BKDTMQ967287Q4UYQD*O%+Q.SQBDO3KLB75EHPSGO0IQT30%5L9UO GOP*OSV8GP4 BLLYPPTQ*88+EQHCRF46L/5R3FMIA:/BMUJBRE19LD9LFKGN9I7YUQK9JWPX4V5%EJWEM/U71A UP$EG5EM745F/93L5DIAF0JEYI1DLNCK1625JUTCE67RV:Q1NNX%71BBZ.EDTSHSE%1JDXNW0D$DJ*TFFYRKUH$3RE%URTESJ7QJTP7G6JVBFJ3OQ.$PE14OBOSBND$VW/QLPBC/4E/TL307MP90';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
  });

  it('should verify ES_2DCode_raw_203', async () => {
    const HC1 = 'HC1:NCF4W1E0APO0030K+HAMK$SB%IHG7RS5P*170UMHGA$+P8AJ9JLC+81JT*17AZQ ZP%M7.ZRP78567DFIKSR/%R2AWCVTOFTFD5C%5SCAY4TR:VV4C:BU47F:TB4/MD1QUERQ7G$SOAQKAVRU6DVBN/OKLUIMGLD/VP*3W%QE3T14NB91WN66C8HVRE$IARVD8GFS1+EFB+IF0PX/4MXI6+83BA0S67S9JN6 X0:W1:%F:QRUW8XH659G9B8EFF:DUY.9/1P%-1EHAY0EAO7/7D:E4CWQP1KL%OWW5Q3P R1TCO2UTE0MTYL*V9F24OZAB.KSZ5*HP%RK7BK-C3EDBOQBC48SV6XALCFL/ 1 U05G3W48LZG//4QSGP3WDFS7NH0S8RBRQ9IYVTF0M63M E5X%LZ19NFA9CTJJFO+HC*A-YTBKN3*SCFRJ*KVICBALJEOF36V$245B6EIRUDS1629NZ NC3COVPF2GUXEE8L5-NKM3YTQ*0WT2BG18T.0O02OUS87W07F/EUX1WKQT//3RU70%JRYFZO46H0W3O40';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
  });

  it('should verify ES_2DCode_raw_1001', async () => {
    const HC1 = 'HC1:NCFOXNYTSFDHJI8Y0PO%K7ING/0B71G.2S+V1ROGO2D PH-I$ZVJ/J5BN4W1$X091HVNBSA3/-2E%5VR5VVBJZI2CB43DIFTWVDD32A/DEMS31EL*SU.CFJS.*TR8TYMCIVT6DLHOJ0 JT$SYZJ0PI0DJXJA  CG8CRCKW9C1QDS1JZEB9VCMCI7UJQWT.+S1QDC8CO8CG8C3AD:XIBEIVG395EV3EVCK09D5WCFVA.QO5VA81K0ECM8CXVDC8C90JK.A+ C/8DXEDKG0CGJ5AL+-46U1VS6/43$ZJ*DJWP4+Y5AHQA34X.4/K6L0C03PQK93R9KYP:X9VH9B/9OK58UERCEHQUCZE.8N0C6YZQTK99:VR*FRLGZUIQJAZGA2:UG%U:D4VC3F I2$I3ZJI8F/%L/:4XYOW2AC.NH9LIPE 8U52G*FRHXMHTUG0E8FR7CB3AQBVK+SPP6OFHJEQQGSOJR1YIN.7FWYHUL6B0E8*315782C$1CNWE4KL$19IZKUA3J5O09UE8T9H99DLRY7O9V6M7NAQ3Y4G7S3/D+OEYRNVYP-GUE3VPOH-T7P*ECQDL2N8G5.WN2S843E8EOH+DMIN3F7W+BP%T+TV-%LL*PLF9N7I$6J$HA/VD:TUK0P/K0M%K0YD%Z5DES%6L/-DB6J%KS7YQR7PLQ5ZR92*2/5R.+CF4D7RRTCT0.RFNU4BWY*2R-P5:O/7K*M9ZUFKFHAARE+SXUKDBAT7GJCJR%L*RPP04F O1%6Z7W IN-7VBZPVWA$%CYNIGYI6-E$XQUGAN20 RNQ1';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Apellido Apellido', 'fnt': 'APELLIDO<APELLIDO', 'gn': 'Nombre', 'gnt': 'NOMBRE'}, 'dob': '2014-08-16', 'v': [{'tg': '840539006', 'vp': '1119349007', 'mp': 'EU/1/20/1528', 'ma': 'ORG-100030215', 'dn': 1, 'sd': 2, 'dt': '2020-08-16', 'co': 'ES', 'is': '10', 'ci': '01ES10V778A77BC630DCE6AD3EEA#5'}]});
  });

  it('should verify ES_2DCode_raw_2103', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HKTGX94G-ICWEXWP0993CM3XH74M6R5J71%JG6NRRD2JP3A M:UC*GPXS4MZKJ$E KE4+GKHGSRD2HICCH IJPII8KLTJL0JKMKNLII+KN%SHPIIDOM1JAM*7PQFZH9C+GYHILIIX2MDKLGHKCCHAJKOHGQ-IJIH4HGN+IRB8Z.C+ILG.CZ.CTC93DAG2OYJ9/H8RJC--C7JC.IAQKC6JKXIMQIAL/DC687+BZ9A+KRA+PE$85FQ2JO YB$S4PCNUHL/B3/SCLL51L2DJP7LPS4QUKOSD1C:H+-9VIOJF85B9-NT0 2$$0X4PCY0+-C1W4/GJI+C7*4M:K364LW4X$7K78RK37MBZD35AL5:4MMOLZ68999Q9E$BDZIS4JMZIZSJ%ZIFGSWLF0QCHZA6LFY:H72GENSLG1-FH E780P1FDYV4JF8Y4OJF8J-6WIKZ6WTNP8EFQLRC9W31M35Q7B8C9WWKP/HLIJL8JF8JF1729DASMA9%F:X70C5%HRZ0G*53XSCUSRRWLZ1OC UC5UB5C-KPQ8VN%9MHH3LDPMENCO9X33FHIMR+RGD6GU+JI1U2REH$SK/C8.GSI3OP3QYH';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Romero Muñoz', 'fnt': 'ROMERO<MUNOZ', 'gn': 'José Carlos', 'gnt': 'JOSE<CARLOS'}, 'dob': '2021-05-28', 't': [{'tg': '840539006', 'tt': 'LP217198-3', 'nm': 'Panbio COVID-19 Ag Test', 'sc': '2021-05-10T10:54:34+02:00', 'dr': '2021-05-10T11:09:34+02:00', 'tr': '260415000', 'tc': 'C.S. BARBASTRO', 'ma': '1232', 'co': 'ES', 'is': 'Ministerio de Sanidad', 'ci': '01ES21T1662955521D74217FDD29#D'}]});
  });

  it('should verify ES_2DCode_raw_101', async () => {
    const HC1 = 'HC1:NCFOXNEG2NBJ5*H:QOS/O.+NEKBS7LOMD7LG -8+W4VGACULYITJ59VWDPWQ+T90X15VC9:BPCNJINQ+MN/Q19QE8QEA7IB65C94JB5IKI-BBJCAEDTLKUYHLZI69JJYJIZIKOJ ZJY1B:JT7ETBFT0I3W6D0OC8ALD-IQA7U*0VSN9Y4.$S6ZCJKB.VJKD34LT5CBN:IN1MPF5RBQ746B46O1N646RM93O5RF6$T61R63B0 %PZIEQKERQ8IY1I$HH%U8 9PS5/IE%TE6UG+ZEAT1HQ13W1:O14SI4UUTNIPPAIMI.J9DYHNF0:Y0VON./G0OPQ985:44$2X49O5L+*IL%4Z7TF+RKCILMLMP1ZXKZW4V/AY73CNN6J3*.GEG3FMJ*E3V53+FNUA3T53VBJ.E3QHBCA5L*83794B1T/RFM5ONR.FQ0Z80LR B7O57K8IIRQX5TFE5 %RT7O98N9CTTARP8L%5MB/II-M+$O4BN+N9J6WX/D-+4NI8NA5SJQ+1Q05WL10C9OX1';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
    expect(await parseCWT(cwtPayload.contents)).to.eql({'ver': '1.0.0', 'nam': {'fn': 'Andaluza Andaluza', 'gn': 'Carmen', 'fnt': 'ANDALUZA<ANDALUZA', 'gnt': 'CARMEN'}, 'dob': '1974-02-28', 'v': [{'tg': '840539006', 'vp': '1119349007', 'mp': 'EU/1/20/1528', 'ma': 'ORG-100030215', 'dn': 2, 'sd': 2, 'dt': '2021-04-21', 'co': 'ES', 'is': 'Servicio Andaluz de Salud', 'ci': '01ES01V1254A083DEF342D693992#9'}]});
  });

  it('should verify ES_2DCode_raw_1102', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HKTGX94G-ICWEXWPH9H9M9ESIARG4YK56C1FP8%V79FK$TF.HO$DK1JZZPQA3DP4OW631AX5QFAIT567U14Q69PM2Y69L6$T6W9EMWERF6Q MHS6.DETA6$%6PK9I+08II-NI  CG8C5DL-9C.PD8IIWGABQSIFTZF30AF1Z8J2K8FFZ.CE%GN9EZCA .CM:C.LG7Y87DA:0E6NSYLV0C58G1TFHQ*K5B9-NT0 2$$0X4PCY0X:CZD5CC9T0HM%2CNNE+4F/87LPMIH-O92UQMTU+W3*C0V$BUQ2RZ3$XJ0WBBPIAYUU-NK$FBX3XZQ5I9ZLIQ9AM.S-YN6DLUDBQEAJJKHHGWC87TGVKSH.4L-J X8P$H:2V8/E:N0Y%5EJS*72W/PLEWV5LR7O*4LM06ZYJNIEF$T$6E:B2A+0Q8SO6O*+FQ/T7OQ.UBDM4*LBZ51M87V50434/FF';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
  });

  it('should verify ES_2DCode_raw_1103', async () => {
    const HC1 = 'HC1:NCFOXN%TSMAHN-HKTGX94G-ICWEXWP769LAU3XH74M6R5DJJP7GBSML0FNIKGN8GYOAZT:ZH6I1$4JM:IP1MPK9V L9L69UEG%6GO1ZC6$T6B46OF68O68BE1VE1H63ZM.963TA0T932Q6G3ZXIRSAPEDG8C5DL-9C1QD/P249DW CYJCW9CA$D6VCF9C.XI5TBPL2*IBX1J*ZJOAM IBZJAOOJWLFJRC5H8QNLF9E3-9 H9/DE:.7/Y4G98E1MFFCJ5Q95WB0M89444M*2MJ25WN5VCN3O07UV.NND-I37LLOJ4NJBIT5S41Q2/JVKON::G%2H8058YISLV423VLJ0JBIFTQ05.$S6ZC0JB4I3KD3LWT383/9TL4T.B9GYPW0282FDTU..1/%HX9EQ-ELSUQK9JWPCT1KFETTE:YU4T9 UPUA8CBMAL5F/93L5DIAF0JEYI1DLNCK162KAELZP+HKT4W01TBPB16EOBCVRNDXDEO7R99T+LG8HCNU%Z0I61S3HWCB+.40Y7IGSR08NSPN1BI:HMLD5EWJ%Q/J7-K9D2MP.O+SGL50E*440';
    const cwtPayload = await unpackAndVerify(HC1);
    expect(cwtPayload).not.to.be.null;
    expect(cwtPayload).not.to.be.undefined;
  });

});

